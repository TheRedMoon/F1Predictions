from __future__ import division
import re
from nltk.corpus import stopwords
from nltk.tokenize import wordpunct_tokenize, sent_tokenize
from nltk.stem import SnowballStemmer, WordNetLemmatizer
from collections import Counter
import nltk
from nltk import precision, recall, f_measure
import sklearn.datasets
import sklearn.metrics
import sklearn.model_selection
from sklearn.svm import SVC
import collections
import pandas
import gensim
from gensim.utils import simple_preprocess
import numpy as np
np.random.seed(2018)
from gensim import corpora, models
from pprint import pprint
from sklearn.svm import SVC
import pickle
from nltk import everygrams
from afinn import Afinn
from nltk.util import ngrams
from operator import itemgetter
from collections import OrderedDict
# Download the 'stopwords' and 'punkt' from the Natural Language Toolkit, you can comment the next lines if already present.
#ontext_frequent_words = ['nigga', 'hoe', 'dick', 'motherfuck', 'rap', 'punk', 'fuckin', 'somethin', 'cent', 'paper', 'dope', 'lil', 'dough', 'unit', 'shot', 'ass', 'gangsta', 'beef', 'bullshit', 'fresh','peep', 'stack', 'hood', 'clap', 'talkin', 'shoot', 'ho', 'flip', 'sayin', 'split', 'cap', 'stunt', 'buck', 'homi', 'mic', 'murder', 'nut', 'mental', 'que', 'bitch', 'bang', 'case', 'blast', 'nah', 'tip', 'polic', 'scene', 'bullet', 'gun', 'test', 'mac', 'dog', 'pimp', 'dirt', 'fiend', '# of lines', 'spot', '# of lines', 'nine', 'citi', 'york', 'rich', 'hit', 'thinkin', 'east', 'suppos', 'benz', 'shit', 'mc', 'havin', 'slap', 'kid', 'tryin', 'coup', 'ruthless', 'west', 'suck', 'fo', 'funki', 'ball', 'gas', 'shootin', 'outsid', 'role', 'crack', 'quick', 'win', 'doubl', 'bus', 'bomb', 'dollar', 'street', 'phone', 'cop', 'heat', 'map', 'dis', 'bubbl', 'foe', 'slang', 'corner', 'weight', 'foot', 'grin', 'lick', 'law', 'lawyer', 'dem', 'drinkin', 'eat', 'sell', 'ill', 'em', 'beyonc', '# of lines', '# of lines', 'runnin', 'fore', 'charg', 'lane', 'pressur', 'cruisin', 'bust', 'lap', 'rhyme', 'makin', 'yea', 'rollin', 'ha', 'wrist', 'asleep', 'pre', 'trash', 'mill', 'talent', 'buddi', 'throwin', 'wit', 'crib', 'weed', 'coke', 'toe', 'fan', 'freak', 'plus', 'block', 'fuck', 'hot', 'class', 'poppin', 'smack', 'screamin', 'underground', 'dust', 'chip', 'tap', 'shawti', 'twenti', 'scheme', 'das', 'form', 'relax', 'shorti', 'school', 'load', 'huh', 'pocket', 'pump', 'outta', 'te', 'wander', 'si', 'pop','fast', 'grab', 'palm', 'pumpin', 'drum', 'duck', 'punch','kissin', 'ta', 'teeth', 'hotel', 'piss', 'fifti', 'cha', 'pad', 'tellin', 'figur', 'ten', 'probabl', 'money', 'throw','rip', 'suffer', 'gettin', 'shop', 'ridin', 'spin', 'bounc', 'doin', 'averag', 'doe', 'poke', 'knowin', 'sho', 'pill', 'jaw', 'extra', 'youth', 'stab', 'cos', 'attitud', 'hustl', 'catch', 'pound', 'neck', 'hat', 'gimm', 'joke', 'coupl', 'funni', 'smoke', 'rappin', 'ski', 'chest', 'th', 'clue', 'smooth', 'um', 'wearin', 'ol', 'gay', 'hangin', 'window', 'ima', 'stare', 'askin', 'trial', 'cut', 'non', 'yellin', 'style', 'bank', 'kick', 'south', 'knock', 'silli']
context_frequent_words =['hood', 'ass', 'nigga', 'fuck', 'hell', 'check', 'niggaz', 'fuckin', 'style', 'tryin', 'que', 'gon', 'shit', 'block', 'homi', 'motherfuck', 'sayin', 'hip', 'rap', 'bitch', 'clip', 'punk', 'cop', 'wit', 'bout', 'cool', 'hoe', 'strap', 'buck', 'por', 'pound', 'vers', 'somethin', 'lil', 'dope', 'dick', 'case', 'parti', 'pump', 'kid', 'pack', 'pop', 'gotta', 'death', 'dough', 'car', 'unit', 'cash', 'tip', 'whip', 'mac', 'test', 'damn', 'jump', 'polic', 'shorti', 'crew', 'deal', 'bread', 'pimp', 'switch', 'dem', 'feelin', 'respect', 'yea', 'rhyme', 'weed', 'bank', 'crazi', 'plus', 'fan', 'slap', 'fresh', 'chill', 'peep', 'stack', 'etern', 'intro', 'sex', 'em', 'club', 'gettin', 'cat', 'brick', 'para', 'rapper', 'hook', 'tryna', 'ho', 'gun', '# of lines', 'happi', 'thou', 'fat', 'mama', 'goin', 'bet', 'bust', 'talkin','cock', 'mic', 'lick', 'finish', 'divin', 'boy', 'sword', 'dumb', 'el', 'buy', 'nut', 'hustl', 'suffer', 'cent', 'paper', 'si', 'coupl', 'wet', 'pretti', 'blast', 'bottl', '# of lines', 'girl', 'wrist', 'takin', 'yeah', 'lyric', 'ghetto','pistol', 'nah', 'mo', 'mr', 'toe', 'gat', 'babe', 'chorus', 'school', 'guess', 'bang', 'ser', 'hot', 'treat', 'huh', 'behold', 'jail', 'shot', 'con', 'blunt', 'scene', 'chrome', 'bail', 'team', 'boss', 'spray', 'roll', 'crack', 'kingdom', 'special', 'fiend', 'sip', 'dre', 'tha', 'money', 'ms', 'bumpin', 'poppin', 'glock', 'smokin', '# of lines', 'en', 'una', 'top', 'everybodi', 'nine', 'jewel', 'jet', 'wrath', 'vez', 'stick', 'bar', 'shall', 'aint', 'benz', 'kick', 'hit', 'flip', 'los', 'juic', 'lean', 'click', 'busi', 'suppos', 'babi', 'battl', 'stage', 'spit', 'givin', 'sucker', 'dump', 'wan', 'freak', 'gang', 'york', 'rich', 'mc', 'clown', 'guy', 'joke', 'seh', 'thinkin', 'te', 'seat', 'buri', 'esta', 'big', 'fantasi', 'gonna', 'neck', 'bentley', 'strip', 'ruthless', 'shadi', 'coup', 'sock', 'bein', 'short', 'forth', 'sick', 'squeez', 'whatev', 'nice', 'thee', 'fo', 'funki', 'drama', 'chao', 'forest', '# of lines', 'gas', 'dude', 'confus', 'super', 'fee', 'slide', 'project', 'wont', 'lookin', 'grab', 'bullshit', 'throne', 'grave', 'eso', 'ball', 'role', 'holla', 'beam', 'list', 'job', 'level', 'spot', 'blowin', 'quick', 'ten', 'todo', 'gate', 'hay', 'rip', 'stupid', '# of lines', 'addict', 'what', 'proper', 'stress', 'skill', 'destroy', 'path', 'es', 'warrior', 'bad', 'cap', 'mack', 'del', 'movi', 'vida', 'shoot', 'clean', 'later', 'pick', '#words with length: 3', 'heat', 'foe', 'artist', 'trigger', 'mom', 'lawyer', 'loos', 'drinkin', 'grin', 'type', 'ancient', 'pue', 'trap', 'slay', 'estoy', 'cliqu', 'brown', 'daddi', 'trip', 'snitch', 'nothin', 'cake', 'walkin', 'mental', 'alreadi', 'sell', 'put', 'runnin', 'dollar', 'split', 'main', 'lap', 'drug', 'movin', 'burnin', 'fifth', 'actin', 'speed', 'flesh', 'tender', 'hous', 'god', 'fail', 'seed', 'circl', 'depth', 'dat', 'charg', 'flick', 'silenc', 'rang', 'joe', 'hittin', 'murder', 'rollin', 'problem', 'jam', 'uh', 'street','wander', 'glori', 'brain', 'rush', 'order', 'third', 'bass', 'rim', 'sack', 'lot', 'trick', 'alright', 'smoke', 'next', 'devour', 'nation', 'comin', 'kickin', 'flow', 'lane', 'eight', 'sittin', 'anyway', 'leavin', 'talent', 'box', 'de', 'join', 'south', 'rid', 'okay', 'mighti', 'proud', 'fact', 'suck', 'spirit', 'hair', 'univers', 'como', 'thang', 'relax', 'either', 'cream', 'court', 'rob', 'scratch', 'hater', 'bigger', 'tap', 'smack', 'aim', 'base', 'quot', 'im', 'talk', 'least', 'hey', 'se', 'weh', 'steppin', 'liquor', 'toni', 'grand', 'shooter', 'creation', 'fue', 'snake', 'mis', 'ya', 'whoa', 'littl', 'earli', 'fix', 'six', 'class', 'barrel', 'toss', 'das', 'tough', 'ja', 'loc', 'twenti', 'straight', '# of once occuring words ratio to all words', 'window', 'pussi', 'reign', 'lo', 'chick', 'stash', 'outta', 'pull', 'load', 'cant', 'piec', 'folk', 'dirt', 'shakin', 'chronic', 'attent', 'snoop', 'hammer', 'victim', 'punch', 'mit', 'er', 'proof','plot', 'palm', 'hotel', 'chop', 'pac', 'hop', 'til', '# of lines', 'thug', 'five', 'date', 'underground', 'screamin', '# of lines', 'ice', 'figur', 'ta', 'dr', 'cha', 'fifti', 'quit', 'stuff', 'piss', 'nightmar', 'blade', 'dond', 'lust', 'cut', 'catch', 'sacr', 'armi', 'kill', '# of lines', 'shell', 'drop', 'deeper', 'that', 'pocket', '# of twice occuring words ratio to all words', 'shut', 'sweat', 'laughter', 'son', 'las', 'knowin', 'rabbit', 'cuz', 'sho', 'dj', 'extra', 'poke', 'coast', 'deck', 'cos', 'video', 'doe', 'higher', 'attempt', 'doubl', 'ladi', 'bounc', 'nasti', 'duck', 'mask', 'pad', 'pumpin', 'phone', 'cloth', 'among', 'number', 'cost', 'champagn', 'attitud', 'rub', 'quarter', 'label', 'pill', 'round', 'weapon', 'tellin', 'point', 'scar', 'sin', 'master', 'havin', 'ayer', 'protect', 'destruct', 'chain', 'someday', 'nuff', 'conquer', 'law', 'di', 'thrill', 'hat', 'front', 'handl', 'livin', 'wanna', 'yo', '# of lines', 'candi', 'dog', 'bag', '# of lines', 'doin', 'yay', 'connect', 'raw', 'smash', 'model', 'camera', 'um', 'cell', 'puff', 'smooth', 'serv', 'askin', 'drivin', 'stare', 'Sentiment', 'Sentiment', 'Sentiment', 'clock', 'wors', 'max', 'ruger', 'averag', 'stab', 'pig', 'yell', 'fulli', 'realli', 'consum', 'trunk', 'yellin', 'shoe', 'correct', 'forti', 'leg', 'naw', 'larg', 'cd', 'aftermath', 'effect', 'ol', 'post', 'boat', 'riot', 'ride', 'momma', 'brand', 'instinct', 'torment', 'ni', 'solo', 'destino', 'unleash', 'crown', 'muy', 'command', 'tiempo', 'work', 'shake', '# of words inc stopwords', 'corner', 'row', 'outsid', 'demon', 'dear', 'ev', 'act', '# of long occuring words ratio to all words', 'closer', 'mankind', 'good', 'dirti', 'hollow', 'game', 'silli', 'better', '# of lines', 'judg', 'non', 'low', 'woo', 'hangin', 'vocal', 'whoever', 'gay', 'west', 'size', 'du', 'jean', 'broad', 'public', 'sever', 'throat', 'behav', 'commit', 'payin', 'startin','probabl', 'repeat', 'instead', 'rippin', 'unless', 'boot', 'playa', 'sub', 'sind', 'ay', 'energi', 'hi', 'shirt', 'eat', 'miseri', 'plagu', 'slave', 'ash', 'ill', 'fit', 'blood', 'chase', 'slow', 'wolf', 'voz', 'train', 'peel', 'reflect', 'reveng', 'tal', 'tortur', 'await', 'merci', 'dice', 'rather', 'jack', 'control', 'clap', '# words with length: 3', '# words with length: 5', 'great', 'righteous', 'beach', 'map', 'mon', 'slang', 'best', 'makin', 'background', 'shoulda', 'album', 'playin', 'cum', 'greet', 'cruis', 'tall', 'beast', 'shape', 'bird', '# of lines', '# of lines', 'skinni', 'uzi', 'deuc', 'mil', 'sucka', 'eh', 'cannon', 'scoop', 'station', 'drip', 'slug', 'mall', 'thigh', 'weav', 'regular', 'cheap', 'violent', 'gear', 'Sentiment', 'Sentiment', '# of words inc stopwords', 'foot', 'match', 'zone', 'fame', 'dip', 'cours', 'truck', 'sinc', 'coke', 'dive', '# of lines', '# of lines', 'sad', 'aw', 'appli', 'bug', 'snatch', 'claim', 'dome', 'mothafuckin', 'mate', 'whenev', 'missin', '# of lines', 'bite', 'crime', 'belief', 'infinit', 'gran', 'hasta', 'mucho', '# words with length: 7', '# of lines', 'womb', 'salvat', 'pen', 'tv', 'insan', 'wreck', 'well', 'glad','hate', '# words with length: 6', 'aris', 'iron', 'rape', 'decay', 'nunca', 'power', 'seal', 'spawn', 'yes', 'posit', 'le','throw', 'Sentiment', 'Sentiment', 'Sentiment', '# of spaces', 'beg', 'explain', 'dress', 'pressur', '# of words inc stopwords', 'monkey', '#words with length: 3', 'get', 'kinda', 'hundr', 'knock', 'ye', 'tu', 'rat', 'chocol', 'automat', 'kitchen', 'owe', 'nintendo', 'usual', 'gutter', 'mal', 'razor', 'cook', 'sich', 'melt', 'babylon', 'emperor', 'ahhh', 'dead', 'Sentiment', 'ear', '# of lines', 'collect', 'offic', 'sober', 'page', 'screw', 'ridin', 'frame', 'cousin', 'ugli', 'east', 'thirti', 'definit', 'anim', 'dub', 'butt', 'mash', 'fault', 'plastic', 'metal', 'curb', 'filthi', 'junki', 'flashi', 'fri', 'captain', 'major', 'nois', 'dread', 'rage', 'holi', 'minut', 'record', 'charm', 'floor', 'bruis', 'judgement', 'first', 'diamond', 'enter', 'joint', 'la', 'heroin', 'method', 'add', 'sunday', 'nose', 'yard', 'partner', 'casket', 'habit', 'degre', 'enhanc', 'dinner', 'wig', 'frown', '# of lines', 'shout', 'hard', '# wordswith length: 2', '# words with length: 4', 'rock', 'howl', 'bath', 'cosmic', 'pero', 'wolv', 'nothing', 'camino', 'receiv', 'surround', '# words with length: 5', 'al', 'mouth', 'su', 'eden', 'paradis', 'legion', 'delight', 'manifest', 'asleep', 'liber', 'loneli', 'smell', 'lock', 'art', 'futur', 'laugh', 'plan', 'perfect', 'step', 'twist', 'final', 'might', 'pictur', 'bed', 'fast', 'lonesom', 'rainbow', 'weari', 'scheme', 'worship', 'limb', 'religion', 'betray', 'mundo', 'unto', 'moral', 'guard', 'black', '# of words inc stopwords', 'wast', 'line', 'even', '# of spaces', '# of sentences', 'dyin', 'girlfriend', 'fã¼r', 'stomach', 'bro', 'purpl', 'keepin', 'uptown', 'gucci', 'stereo', 'mill', '# of lines', 'sure', 'beyond', 'vein', 'ignor', 'crush', 'fake', '# of sentences', 'trippin', 'bend', 'Sentiment', 'person', 'freez', 'Sentiment', 'read', 'bodi', 'wick', '# of words inc stopwords', 'jah', 'track', 'eighti', 'jake', 'hoop', 'deserv', 'layin', 'bulletproof', 'privat', 'experi', 'visit', 'alarm', 'actual', 'couch', 'weekend', 'hypnot', 'plant', 'dose', 'critic', 'smith', 'van', 'avoid', 'sale', 'po', 'sort']

#based on 1200 songs per genre
context_frequent_words = ['nigga', 'ass', 'hood', 'fuck', 'gon', 'rap', 'check', 'homi', 'cent', 'tryin',  'bout', 'nothin', 'shit', 'niggaz', 'huh', 'vers', 'dope', 'fuckin', 'hoe', 'cl ip', 'bitch', 'dem', 'dick', 'comin', 'uh', 'strap', 'punk', 'benz', 'style', 'f lip', 'tryna', 'pimp', 'buck', 'feelin', 'pop', 'motherfuck', 'lil', 'crew', 'sh ot', 'dough', 'etern', 'shorti', 'coupl', 'intro', 'mama', 'cat', 'diamond', 'co ol', 'york', 'plus', 'dj', 'stack', 'mac', 'hip', 'peep', 'jack', 'nah', 'goin',  'parti', 'gotta', 'cop', 'cash', 'mic', 'fo', 'cock', 'wit', '# of lines', 'pac k', 'gang', 'switch', 'tha', 'pound', 'unit', 'takin', 'rhyme', 'deal', 'team', 'club', 'lookin', 'twenti', 'damn', 'busi', 'cap', 'pistol', 'hater', 'money', ' type', 'trap', 'jewel', 'ball', 'fifti', 'holla', 'school', 'weed', 'ay', 'smoki n', 'kid', 'em', 'blunt', 'whip', 'boy', 'reign', 'thug', 'bust', 'ho', 'mc', 'g uy', 'sex', 'sucker', 'bounc', 'slide', 'chrome', 'squeez', 'wrath', 'brick', '#  of lines', 'buy', 'girl', 'dump', 'test', 'jah', 'special', 'raw', 'mr', 'warri or', 'jet', 'spit', 'super', 'juic', 'block', 'seh', 'funki', 'sack', 'wrist', ' dip', 'para', 'coup', 'fan', 'gat', 'nut', 'hook', 'dollar', 'sip', 'fifth', 'pa c', 'okay', 'dumb', 'dude', 'somethin', 'case', 'cream', 'sayin', 'ice', 'polic' , 'crazi', 'rang', 'havin', 'bail', 'torment', 'su', 'yea', 'car', 'click', 'cak e', 'beach', 'coast', 'bank', 'dre', 'aris', 'blowin', 'flesh', 'bread', 'drinki n', 'skill', 'mack', 'stupid', 'eight', 'cook', 'big', 'bass', 'kitchen', 'hitti n', 'tip', 'ghetto', 'project', 'pressur', 'playa', 'roll', 'nice', 'pussi', 'le g', 'drug', 'underground', 'fiend', 'babi', 'extra', 'actin', 'snitch', 'hi', 'r im', 'await', 'nightmar', 'bigger', 'mall', 'wan', 'proper', 'boss', 'poppin', ' treat', 'blast', 'bag', 'neck', 'hustl', 'kickin', 'screamin', 'shadi', 'trunk',  'everybodi', '# of lines', 'bang', 'split', 'mo', 'hot', 'clap', 'bentley', 'pi ss', 'trigger', 'spot', 'destroy', 'shooter', 'rip', 'movin', 'tap', 'broad', 'p ump', 'spray', 'glock', 'devour', 'decay', 'dat', 'babe', 'ladi', 'joint', 'size ', 'sho', 'lap', 'bumpin', 'chill', 'bro', 'cliqu', 'bar', 'ancient', 'gettin', 'toe', 'todo', 'blade', 'nine', 'doubl', 'level', 'model', 'court', 'slap', 'art ist', 'naw', 'trippin', 'conquer', 'yeah', 'base', 'what', 'hotel', 'sock', 'kic k', 'list', 'shoe', 'snatch', 'lyric', 'plagu', 'rapper', 'drama', 'freak', '# o f lines', 'leavin', 'momma', 'por', 'butt', 'mom', 'bottl', 'hell', 'hous', 'ser ', 'lot', 'depth', 'jail', 'daddi', 'top', 'chao', 'sweat', 'thigh', 'boat', 'um ', 'punch', 'talkin', 'thang', 'rich', 'lean', 'livin', 'smoke', 'bet', 'bullshi t', 'crush', 'hit', 'video', 'lawyer', 'talk', 'label', 'deck', 'ol', 'tortur', 'fat', 'crack', 'demon', 'gun', 'vida', 'armi', 'vez', 'lick', 'pill', 'steppin' , 'forth', 'attitud', 'cd', 'askin', 'cha', 'map', 'weh', 'chop', '# of lines', 'los', 'dirti', 'strip', 'sick', 'ms', 'las', 'barrel', 'rabbit', 'pad', 'larg',  'sucka', 'ruthless', 'dub', 'doe', 'smack', 'metal', 'quit', 'fresh', 'stress',  'liquor', 'silenc', 'addict', 'aint', 'ev', 'pocket', 'loc', '# words with leng th: 5', 'reveng', 'runnin', 'shell', 'throat', 'screw', 'correct', 'quot', 'burn in', 'sword', 'quick', 'match', 'brown', 'duck', 'stuff', 'walkin', 'put', '# of  lines', 'missin', 'murder', 'poke', 'plot', 'public', 'cell', 'sittin', 'shoot' , 'bein', 'rage', 'eso', 'hat', 'ruger', 'yo', 'finish', 'lust', 'yard', 'ta', ' ja', 'automat', 'kingdom', '# words with length: 3', 'clown', '# of lines', 'slu g', 'knowin', 'chronic', 'collect', 'stick', 'estoy', '# of once occuring words ratio to all words', 'pretti', 'pig', 'hair', 'respect', 'problem', 'cuz', 'una' , 'death', 'talent', 'mothafuckin', 'gas', 'rub', 'movi', 'fake', 'di', 'hollow' , 'dirt', 'liber', 'hey', '# of lines', 'yay', 'snoop', 'dome', 'puff', 'po', 'g onna', 'rollin', 'mon', 'job', 'sell', 'suppos', 'forest', 'station', 'max', 'ro b', 'connect', 'main', 'playin', 'owe', 'shall', 'shape', 'background', 'skinni' , 'effect', 'critic', '# of lines', 'snake', 'pen', 'chick', 'como', 'straight',  'chocol', 'that', 'either', 'trip', 'toni', 'legion', 'someday', '# of lines', 'hangin', 'rippin', 'esta', '# of long occuring words ratio to all words', 'bloo d', 'tv', 'girlfriend', 'mil', 'third', 'slang', 'bulletproof', 'stash', 'slay',  'univers', 'mis', 'later', 'battl', 'fue', 'pue', 'regular', 'crown', 'sacr', ' unto', 'next', 'six', 'pull', 'nasti', 'album', 'captain', 'eighti', 'yellin', ' zone', 'alright', 'glori', '# of words inc stopwords', 'clean', 'mankind', 'grab ', 'ten', 'ya', 'mighti', '# of lines', '# of lines', 'dear', 'weav', 'smith', ' definit', 'jump', 'date', 'twist', 'scratch', 'speed', '# of words inc stopwords ', 'moral', 'wolf', 'shirt', 'boot', 'class', 'el', 'knock', 'tender', 'trick', 'wander', '# of lines', 'paper', 'jean', '# of lines', 'wet', 'das', 'wig', 'del ', 'shakin', 'smash', 'grin', 'fail', 'destruct', 'littl', 'startin', 'attempt',  'posit', 'curb', 'mit', 'uzi', 'layin', 'energi', 'betray', '# of short occurin g words ratio to all words', '# words with length: 4', 'wanna', 'averag', 'gate' , '# of lines', 'palm', 'proof', 'wont', 'ugli', 'Sentiment', 'consum', '# of li nes', '# of lines', 'kill', 'outta', 'lane', 'beast', 'es', 'cut', 'probabl', 'm ash', 'sever', 'scoop', 'actual', 'anim', 'beam', 'dyin', 'keepin', 'whoever', ' front', 'street', '# of words inc stopwords', 'rape', 'tiempo', 'dond', 'fee', ' confus', 'bad', 'seal', 'belief', 'drop', 'nose', 'joke', 'partner', 'sunday', ' row', 'champagn', '# of spaces', 'alreadi', 'among', '# of lines', 'payin', 'raz or', 'cannon', 'couch', 'enter', 'cloth', 'im', 'load', 'rock', 'aim', 'que', 'c horus', 'ash', 'ayer', 'spawn', 'mental', 'south', 'role', 'mouth', 'thinkin', ' happi', 'brain', 'offic', 'behav', 'dinner', 'eh', 'doin', 'work', 'givin', 'ham mer', 'heat', 'aw', 'forti', 'unless', 'dr', '# of words inc stopwords', 'major' , '# of spaces', 'master', 'gay', 'suffer', 'makin', 'law', 'shut', 'stereo', '#  of words inc stopwords', 'Sentiment', '# of lines', '# of lines', 'judgement', 'dice', 'sober', 'creation', '# of words inc stopwords', 'rid', 'bug', 'earli', 'fix', 'emperor', 'destino', 'limb', 'muy', '# of lines', 'five', 'instead', '# words with length: 7', 'serv', 'Sentiment', 'Sentiment', '# words with length: 6 ', 'suck', 'du', 'enhanc', 'record', '# words with length: 2', 'wreck', 'dog', ' figur', '# words with length: 7', 'miseri', '# of lines', 'lonesom', '# of words  inc stopwords', '# of lines', 'low', 'stomach', 'toss', 'good', '# of lines', ' # of lines', 'camera', 'foe', 'thirti', 'hoop', 'charg', 'filthi', 'violent', 'r ound', 'candi', 'silli', 'hundr', 'lock', 'path', 'Sentiment', 'divin', 'chain',  'mundo', 'pero', 'cum', 'better', 'nunca', '# of lines', 'join', 'catch', 'til' , '# of words inc stopwords', '# of words inc stopwords', '# of words inc stopwo rds', 'thou', '# of lines', '# of lines', '# of spaces', 'sind', 'flow', '# of w ords', 'grave', 'ahhh', 'behold', 'sale', 'fri', 'fit', 'point', 'worship', 'jam ', 'black', 'babylon', 'track', '# of lines', 'get', '# of words inc stopwords',  '# of words inc stopwords', 'joe', 'grand', '# words with length: 8', '# words with length: 7', '# of twice occuring words ratio to all words', '# of long occu ring words ratio to all words', 'handl', '# of words inc stopwords', '# of lines ', '# of lines', 'privat', 'flashi', 'add', 'drip', 'number', '# of words', 'Sen timent', 'loneli', 'Sentiment', '# of lines', 'er', 'fulli', 'peel', 'nothing', 'plan', 'Sentiment', 'hasta', 'eden', 'game', 'wolv', 'alarm', '# of words inc s topwords', '# of words inc stopwords', 'tal', '# of spaces', 'eat', '# of words inc stopwords', '# of lines', 'guess', 'box', 'pick', 'ride', 'avg line word len gth', 'Sentiment', 'folk', 'en', 'ill', 'smooth', 'nintendo', 'mal', 'sich', 'ye ll', '# of spaces', 'ridin', 'loos', 'stage', 'vocal', '# of words inc stopwords ', 'Sentiment', '# of lines', '# of lines', '# of lines', 'Sentiment', 'fact', ' dose', 'glad', 'well', 'cosmic', 'mask', 'mill', '# words with length: 6', 'cost ', 'flick', 'purpl', 'quarter', 'scheme', 'cheap', '# of words', 'window', 'thri ll', '# of lines', 'truck', 'cruis', 'camino', '# of words inc stopwords', '# of  words inc stopwords', '# of words inc stopwords', 'Sentiment', 'cant', '# of sp aces', 'Sentiment', 'gucci', 'gear', 'stab', 'heroin', 'west', 'realli', 'mucho' , 'kinda', 'seat', 'read', '# of words inc stopwords', '# of words inc stopwords ', '# of words inc stopwords', '# of words inc stopwords', 'gran', 'vein', '# of  short occuring words ratio to all words', 'relax', '# of spaces', '# of spaces' , '# words with length: 5', 'coke', '# of once occuring words ratio to all words ', '# of long occuring words ratio to all words', '# of long occuring words rati o to all words', '# words with length: 3', '# words with length: 3', 'fã¼r', 'ra inbow', 'lo', 'act', 'riot', 'aftermath', 'usual', 'command', 'hop', 'circl', 'S entiment', '# of words inc stopwords', '# of spaces', '# of words', '# words wit h length: 6', '# words with length: 6', '# words with length: 3', 'seed', '# wor ds with length: 5', '# of short occuring words ratio to all words', 'fantasi', ' power', '# of spaces', 'experi', 'deuc', 'nation', '# of lines', 'uptown', 'yes' , 'even', 'bend', 'howl', 'floor', 'fame', 'fast', 'Sentiment', 'crime', 'bath',  'whatev', 'pictur', 'hate', 'Sentiment', 'Sentiment', 'bite', 'hard', 'sad', '#  of lines', '# of words inc stopwords', '# of words inc stopwords', 'sort', 'pos t', 'sin', '# of words', '# of words inc stopwords', 'salvat', '# of words inc s topwords', '# of words inc stopwords', '# words with length: 7', 'minut', 'rathe r', '# of words inc stopwords', 'Sentiment', '# of short occuring words ratio to  all words', 'Sentiment', '# of lines', '# of lines', '# of spaces', '# of space s', 'plant', 'appli', 'weekend', 'plastic', 'jake', '# words with length: 9', 's mell', 'dress', '# words with length: 8', 'pumpin', 'gutter', '# of spaces', 're flect', 'Sentiment', '# words with length: 6', '# words with length: 6', '# of s hort occuring words ratio to all words', 'insan', 'scene', '# words with length:  2', '# of words inc stopwords', 'Sentiment', 'get', 'cousin', 'bruis', '# of wo rds inc stopwords', '# of words inc stopwords', '# of words inc stopwords', '# o f words inc stopwords', '# of spaces', '# of spaces', '# of spaces', '# of words ', '# of words', '# words with length: 7', '# words with length: 6', 'avg line w ord length', '# words with length: 6', '# of lines', 'bodi', 'brand', 'wors', 'a l', 'shout', '# of words inc stopwords', 'Sentiment', 'scar', 'foot', 'first', ' train', 'unleash', 'frame', 'control', 'throne', '# of long occuring words ratio  to all words', 'thee', '# of spaces', '# of spaces', '# of long occuring words ratio to all words', 'Sentiment', 'anyway', '# of lines', '# of lines', 'buri', '# of short occuring words ratio to all words', 'clock', 'step', 'junki', 'Senti ment', 'Sentiment', 'best', 'tellin', '# of words', 'Sentiment', 'van', '# of sp aces', '# of spaces', '# of words inc stopwords', '# of words', 'se', '# of spac es', 'Sentiment', '# words with length: 7', '# words with length: 7', 'Sentiment ', '# of twice occuring words ratio to all words', '# of long occuring words rat io to all words', '# words with length: 6', '# words with length: 3', 'spirit', 'rat', '# of words inc stopwords', '# of sentences', 'son', '# of spaces', 'avg line word length', 'Sentiment', '# of words inc stopwords', '# words with length : 8', 'attent', 'womb', 'shoulda', '# of lines', '# of twice occuring words rati o to all words', '# words with length: 6', '# words with length: 3', 'outsid', ' # of long occuring words ratio to all words', '# of long occuring words ratio to  all words', '# of words', '# words with length: 5', 'casket', 'phone', 'slave',  'higher', '# of lines', '# of words inc stopwords', '# of words inc stopwords',  '# of words inc stopwords', '# of words inc stopwords', '# of spaces', '# of sp aces', '# of words', '# of words', 'ye', '# words with length: 8', '# words with  length: 8', '# words with length: 7', '# words with length: 7', '# of long occu ring words ratio to all words', 'freez', 'least', 'avg word length', '# words wi th length: 8', 'throw', '# of words inc stopwords', 'Sentiment', '# of sentences ', 'Sentiment', 'slow', '# of words inc stopwords', 'Sentiment', 'dead', '# of w ords', 'Sentiment', '# of words inc stopwords', 'visit', 'avg line char length',  'weapon', 'cours', '# of lines', 'hay', '# of words', 'Sentiment', '# words wit h length: 5', 'tall', '# of twice occuring words ratio to all words', 'Sentiment ', 'Sentiment', 'short', 'whenev', '# words with length: 3', '# words with lengt h: 3', 'avg line word length', '# of words', '# of spaces', 'Sentiment', 'bird',  'wick', 'ignor', '# of words inc stopwords', '# of words inc stopwords', 'sinc' , 'solo', '# of spaces', '# of spaces', '# of spaces', '# of spaces', '# of spac es', 'con', '# of words', '# of spaces', 'paradis', '# of long occuring words ra tio to all words', '# words with length: 7', '# of lines', '# of twice occuring words ratio to all words', 'east', '# words with length: 2', '# words with lengt h: 5', '# words with length: 5', '# of words inc stopwords', '# of words inc sto pwords', 'guard', 'piec', '# of long occuring words ratio to all words', '# of l ong occuring words ratio to all words', 'whoa', 'mate', 'Sentiment', 'Sentiment' , '# of chars', '# words with length: 9', '# words with length: 9', '# of words' , '# of words', '# of words', 'order', 'protect', '# words with length: 8', 'bey ond', '# words with length: 3', 'monkey', '# words with length: 2', '# words wit h length: 7', '# words with length: 4', '# words with length: 4', '# words with length: 9', '# of once occuring words ratio to all words', 'righteous', '# of lo ng occuring words ratio to all words', '# words with length: 4', '# of once occu ring words ratio to all words', 'chase', 'habit', 'avg line char length', 'Senti ment', '# of words inc stopwords', '# of words inc stopwords', '# of spaces', '#  of spaces', '# words with length: 9', '# of words', '# words with length: 8', ' # words with length: 2', '# words with length: 7', '# of long occuring words rat io to all words', '# of long occuring words ratio to all words', '# of long occu ring words ratio to all words', '# words with length: 6', '# words with length: 3', '# words with length: 5', '# words with length: 5', 'Sentiment', 'avg line c har length', 'shake', '# words with length: 4', '# of chars', '# words with leng th: 5', '# words with length: 3', '# of lines', '# words with length: 7', '# of words', '# of spaces', '# of words inc stopwords', '# of words inc stopwords', ' # of words inc stopwords', '# of words inc stopwords', '# of words inc stopwords ', 'Sentiment', 'Sentiment', '# of lines', 'commit', 'victim', '# of sentences',  'tough', '# words with length: 5', '# words with length: 3', 'manifest', 'drivi n', '# words with length: 4', '# words with length: 8', '# words with length: 5' , '# of words', '# of words', '# words with length: 6', '# words with length: 6' , '# of once occuring words ratio to all words', '# of twice occuring words rati o to all words', '# of twice occuring words ratio to all words', 'sure', '# of s paces', '# words with length: 7', '# of short occuring words ratio to all words' , '# of words inc stopwords', 'Sentiment', '# of words', '# words with length: 2 ', 'voz', 'infinit', '# of spaces', '# words with length: 8', '# of short occuri ng words ratio to all words', 'Sentiment', '# words with length: 3', '# of words  inc stopwords', '# of words inc stopwords', '# of chars', '# of short occuring words ratio to all words', '# words with length: 2', 'page', 'Sentiment', 'si', '# of sentences', '# words with length: 7', 'degre', '# of words inc stopwords',  '# of spaces', 'final', '# of words', '# of lines', '# of words inc stopwords',  '# words with length: 8', '# of lines', '# words with length: 7', '# of words i nc stopwords', '# of words inc stopwords', '# of words inc stopwords', '# of wor ds inc stopwords', '# words with length: 6', '# words with length: 5', 'corner',  'Sentiment', 'Sentiment', 'avoid', 'iron', 'avg line word length', '# of lines' , '# of lines', '# of lines', 'Sentiment', 'Sentiment', 'stare', 'Sentiment', 'l ine', '# of words inc stopwords', '# of words inc stopwords', '# of lines', '# o f spaces', '# of spaces', '# of spaces', '# of spaces', '# words with length: 9' , '# of words', '# of words', '# of words', '# words with length: 10', '# of spa ces', '# words with length: 8', 'ear', '# words with length: 2', 'frown', '# of twice occuring words ratio to all words', '# of twice occuring words ratio to al l words', '# of long occuring words ratio to all words', '# of long occuring wor ds ratio to all words', '# of long occuring words ratio to all words', '# of lon g occuring words ratio to all words', '# of long occuring words ratio to all wor ds', '# words with length: 6', '# of lines', '# words with length: 3', '# words with length: 5', '# of words inc stopwords', '# of words inc stopwords', '# of w ords inc stopwords', '# of words inc stopwords', '# of short occuring words rati o to all words', '# of long occuring words ratio to all words', '# of long occur ing words ratio to all words', '# words with length: 4', 'laughter', '# of space s', '# of spaces', '# of spaces', '# of spaces', '# of spaces', '# of spaces', ' # of spaces', '# of sentences', 'Sentiment', 'Sentiment', '# words with length: 9', '# of words', '# of words', '# of words', 'avg line word length', '# words w ith length: 8', '# words with length: 8', '# words with length: 8', '# words wit h length: 8', '# of once occuring words ratio to all words', '# words with lengt h: 10', '# words with length: 9', '# words with length: 9', '# words with length : 9', '# words with length: 2', '# words with length: 7', 'Sentiment', '# words with length: 8', '# words with length: 6', '# words with length: 3', '# words wi th length: 5', '# words with length: 5', '# of short occuring words ratio to all  words', '# of short occuring words ratio to all words', '# of short occuring wo rds ratio to all words', '# words with length: 7', '# of spaces', 'non', '# of o nce occuring words ratio to all words', '# of long occuring words ratio to all w ords', '# words with length: 3', '# words with length: 3', '# words with length:  4', '# words with length: 7', '# of lines', '# of lines', '# words with length:  3', '# words with length: 3', 'cos', 'dread', '# words with length: 5', '# of c hars', 'Sentiment', '# of short occuring words ratio to all words', 'greet', '# of spaces', '# of words inc stopwords', '# of words inc stopwords', '# of spaces ', '# of spaces', '# of spaces', '# of spaces', '# words with length: 5', '# wor ds with length: 9', '# of words', '# of words', '# of words', '# of words', '# w ords with length: 2', '# words with length: 2', '# words with length: 2', '# wor ds with length: 7', '# of twice occuring words ratio to all words', '# of twice occuring words ratio to all words', '# of long occuring words ratio to all words ', '# words with length: 6', 'rush', '# words with length: 3', '# words with len gth: 3', '# words with length: 5', '# words with length: 5', '# of short occurin g words ratio to all words', '# words with length: 4', 'avg line word length', ' avg line word length', 'avg line word length', 'avg line word length', 'avg line  char length', 'Sentiment', 'person', '# of short occuring words ratio to all wo rds', '# of long occuring words ratio to all words', 'Sentiment', '# of words', '# of words', '# of words', '# of words', '# words with length: 9', 'ni', '# of words inc stopwords', '# of words inc stopwords', '# of words inc stopwords', '#  of words inc stopwords', '# of words inc stopwords', '# of words inc stopwords' , '# of lines', '# of words inc stopwords', '# of words inc stopwords', '# words  with length: 4', '# of short occuring words ratio to all words', '# words with length: 4', '# words with length: 3', '# of long occuring words ratio to all wor ds', '# words with length: 7', '# words with length: 7', '# words with length: 2 ', '# of once occuring words ratio to all words', '# of short occuring words rat io to all words', '# of short occuring words ratio to all words', '# words with length: 3', '# of sentences', '# of words', '# of words', '# of words', '# words  with length: 6', '# of long occuring words ratio to all words', '# of twice occ uring words ratio to all words', '# words with length: 9', '# of twice occuring words ratio to all words', '# words with length: 7', '# words with length: 2', ' nuff', '# of long occuring words ratio to all words', '# words with length: 8', '# of words inc stopwords', '# words with length: 2', 'holi', '# of spaces', '# of spaces', '# of words inc stopwords', '# of words inc stopwords', 'Sentiment',  'Sentiment', '# words with length: 5', '# of spaces', '# of long occuring words  ratio to all words', '# of twice occuring words ratio to all words', '# of shor t occuring words ratio to all words', '# words with length: 3', '# words with le ngth: 3', '# of lines', '# words with length: 2', 'god', '# of long occuring wor ds ratio to all words', 'Sentiment', 'de', '# of lines', '# words with length: 7 ', '# words with length: 5', '# of words', '# words with length: 6', 'Sentiment' , '# words with length: 9', '# words with length: 9', '# of spaces', '# words wi th length: 5', '# of words', '# of words', '# words with length: 9', '# of words  inc stopwords', 'perfect', '# of spaces', '# of spaces', '# of spaces', '# of s paces', '# of spaces', '# of spaces', '# of spaces', 'repeat', 'art', '# of word s inc stopwords', '# of words inc stopwords', 'judg', '# words with length: 4', '# of lines', 'fault', 'deeper', 'charm', '# words with length: 7', 'futur', '# of words', 'le']

stop_words = set(stopwords.words('english'))
#https://www.nltk.org/book/ch06.html
featuresets = []
# Load the dataset into memory from the filesystem
total_races = 22
number_of_drivers = 20

def load_features():
	trainfeatures = []
	data = pandas.read_csv('Features1.csv', delimiter=',', encoding="utf-8-sig")
	featureslist = data['0']
	genrelist = data['1']
	for i in data_text:
		#print(data_text)
		f,g = data_text[i]
		trainfeatures.append((f,g))
	return trainfeatures

def apply_margin(margins, data2018,nr_of_races_raced):
	result = []
	race = "nan"
	for y in range(total_races - nr_of_races_raced):
		#data2018.drop(data2018.index[[0,nr_of_races_raced*number_of_drivers*(y+1)]])
		drop = nr_of_races_raced*number_of_drivers
		if(y > 0):
			data2018 = data2018[drop:]
		#print(drop)
		#print(data2018)
		for x in range(1,21):
			p = x+(y*20)
			if(x % 20 == 1):
				print("set race")
				race = data2018['RaceTable__Races__raceName'].iloc[0]
			driver = data2018['RaceTable__Races__QualifyingResults__Driver__familyName'][p-1]
			position = x
			constructor = data2018['RaceTable__Races__QualifyingResults__Constructor__name'][p-1]
			time_2018 = ""
			if(x < 11):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q3'][p-1]
				
			if(x > 10 and x <16):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q2'][p-1]
				
			if(x > 15):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q1'][p-1]
			margin = 0
			if(isinstance(time_2018, str)):
				time_2018 = time_2018.replace(".", "")
				time_2018 = time_2018.replace(":", "")
			for z in range(len(margins)):
				if(driver in margins[z]):
					margin = margins[z].rsplit(',', 1)[-1]
			time_prediction = float(margin) * float(time_2018)
			#print(race, driver)
			result.append((race,driver,time_prediction))
	print(len(result))
	return result
	
def get_marges(data2018, data2019, nr_of_races_raced):
	margins = []
	race_name = "nan"
	round = 0;
	for y in range(nr_of_races_raced):
		for x in range(1,21):
			if(x == 1):
				round = round + 1
				race_name = data2018['RaceTable__Races__raceName'].iloc[0]
			time_2019 = ""
			time_2018 = ""
			driver = data2018['RaceTable__Races__QualifyingResults__Driver__familyName'][x-1]
			position = x
			constructor = data2018['RaceTable__Races__QualifyingResults__Constructor__name'][x-1]
			print(driver)
			date_2019_filtered = data2019[data2019.RaceTable__Races__QualifyingResults__Driver__familyName == driver]
			if(date_2019_filtered.empty):
				continue
			if(x < 11):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q3'][x-1]
				
			if(x > 10 and x <16):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q2'][x-1]
				
			if(x > 15):
				time_2018 = data2018['RaceTable__Races__QualifyingResults__Q1'][x-1]
				
			print(round)
			print(date_2019_filtered)
			time_2019_q3 = date_2019_filtered['RaceTable__Races__QualifyingResults__Q3'].iloc[round-1]
			time_2019_q2 = date_2019_filtered['RaceTable__Races__QualifyingResults__Q2'].iloc[round-1]
			time_2019_q1 = date_2019_filtered['RaceTable__Races__QualifyingResults__Q1'].iloc[round-1]
			
			isQ3 = isinstance(time_2019_q3, str)
			isQ2 = (not isQ3 and isinstance(time_2019_q2, str))
			if(isQ3):
				time_2019 = time_2019_q3
			elif(isQ2): 
				time_2019 = time_2019_q2
			else:
				time_2019 = time_2019_q1
			
			margin = 0
			if(isinstance(time_2018, str) and isinstance(time_2019, str)):
				time_2018 = time_2018.replace(".", "")
				time_2018 = time_2018.replace(":", "")
				time_2019 = time_2019.replace(".", "")
				time_2019 = time_2019.replace(":", "")
				margin = float(time_2019)/float(time_2018)
			result = driver + ',' + race_name + "," + str(margin) 
			margins.append(result)		
				
	return margins

def get_prediction(predictions, name):
	#print(predictions)
	driver_times = []
	for y in range(len(predictions)):
		race,driver,time = predictions[y]
		if(name in race):
			#print(driver)
			if(time != 0.0):
				driver_times.append((driver,time))
	#print(driver_times)
	return sorted(driver_times, key=itemgetter(1))
	
		
	
def make_pretty(rankedlist,raceName):
	result = "\t\t\t" + raceName + "\t\t\t" + "\n\n\n"
	for x in range(len(rankedlist)):
		driver,time = rankedlist[x]
		print(time)
		time = str(time)[:6]
		print(time)
		finaltime = time[0] + ":" + time[1:3] + "." + time[3:6]
		#TODO add constructor
		if(driver in "Vettel Gasly Pérez Kvyat Stroll Sainz Leclerc"):
			result = result + "Grid position: " + str(x+1) + "\t" + "Driver: " + driver + "\t\t" + "Time expected: " + finaltime + "\n"
		else:
			result = result + "Grid position: " + str(x+1) + "\t" + "Driver: " + driver + "\t" + "Time expected: " + finaltime + "\n"
	return result
# The main program
def main():
	data_2018 = pandas.read_csv('f1_2018.csv', encoding='utf-8', error_bad_lines=False)
	data_2019 = pandas.read_csv('f1_2019.csv', encoding='utf-8', error_bad_lines=False)
    
	#song_genres = load_data_genres(data)
	data_2018_text = (data_2018[['RaceTable__Races__round', 'RaceTable__Races__QualifyingResults__position', 'RaceTable__Races__raceName', 'RaceTable__Races__QualifyingResults__Q3', 'RaceTable__Races__QualifyingResults__Q2', 'RaceTable__Races__QualifyingResults__Q1', 'RaceTable__Races__QualifyingResults__Constructor__name', 'RaceTable__Races__QualifyingResults__Driver__familyName']])
	data_2019_text = (data_2019[['RaceTable__Races__round', 'RaceTable__Races__QualifyingResults__position', 'RaceTable__Races__raceName', 'RaceTable__Races__QualifyingResults__Q3', 'RaceTable__Races__QualifyingResults__Q2', 'RaceTable__Races__QualifyingResults__Q1','RaceTable__Races__QualifyingResults__Constructor__name', 'RaceTable__Races__QualifyingResults__Driver__familyName']])
	nr_of_races_raced = data_2019_text[data_2019_text.RaceTable__Races__round > 0].shape[0]
	margins = get_marges(data_2018_text, data_2019_text,nr_of_races_raced)
	print(margins)
	prediction = apply_margin(margins, data_2018_text,nr_of_races_raced)
	raceName = "Brazilian Grand Prix"
	rankedList = get_prediction(prediction, raceName)
	result = make_pretty(rankedList,raceName)
	#print()
	print(result)

	
#mean of all qualification times of the driver vs the mean of the other driver throughout the years on this circuit.
	
if __name__ == '__main__':
    main()
